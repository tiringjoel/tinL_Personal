%-------------------------
%big-picture
%(c) H.Buchmann FHNW 2008
%$Id$
%export TEXINPUTS=${HOME}/fhnw/edu/:${HOME}/fhnw/edu/tinL/config/latex:${HOME}/fhnw/edu/config//:
%-------------------------
\documentclass{beamer}
\usepackage{latex/beamer}
\input{defines.tex}
\input{/home/buchmann/latex/dirtree/dirtree.tex}

\title[Netzwerk]{Netzwerk}
\begin{document}

\frame{\titlepage}

\begin{frame}{Ziel}{\target am Schulnetz}
 \begin{itemize}
  \item Verschiedene Netze
  \begin{itemize}
   \item {\em Schulnetz} passwortgeschützt
   \item {\em lokales Netz} \host{} \target 
  \end{itemize}
  \item Gesucht
  \begin{itemize}
   \item Verbindung {\em Schulnetz} $\leftrightarrow$ {\em lokales Netz}
  \end{itemize}
  \item Wichtiger Begriff
  \begin{description}
   \item[Proxy] Stellvertreter
  \end{description}
  \item Was wir möchten
  \begin{itemize}
   \item \cod{HTTP} auf \target
   \item \cod{apt-get ...}
  \end{itemize}
 \end{itemize}
\end{frame}

\begin{frame}{Zwei Netze}{zwei Rechner}
 \begin{center}
 \includegraphics[width=0.875\textwidth]{two-networks.png}
 \end{center}
 \begin{itemize}
  \item Netze
  \begin{description}[LokalesNetz (LN)]
  \item[Schulnetz   (SN)] {\em mit} Verbindung zum Internet
  \item[LokalesNetz (LN)] {\em ohne} Verbindung zum Internet
  \end{description}
  \item Rechner
  \begin{description}[\target(BBB)]
   \item[Workstation(WS)] am SN und LN
   \item[\target(BBB)] am LN  
  \end{description}
 \end{itemize}
\end{frame}

\section{HTTT Proxy}

\begin{frame}{Proxy}{Stellvertreter}
  \begin{center}
 \includegraphics[width=0.875\textwidth]{proxy.pdf}
 \end{center}
 \begin{itemize}
  \item Server auf \host
  \item reicht die \cod{http} {\em requests/responses} weiter
 \end{itemize}

\end{frame}

\begin{frame}{Test mit \cod{curl}}{\url{http://curl.haxx.se/}}
  \begin{itemize}
   \item \cod{curl address}
   \begin{itemize}
    \item \cod{curl fhnw.ch}
   \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Proxy Server}{zwei Vorschläge}
 \begin{itemize}
  \item \cod{polipo}
   \vspace{-5mm}
   \begin{quote} 
   is a lightweight caching and forwarding web proxy server
   \end{quote}
%   \vspace{-5mm}
   \begin{itemize}
    \item {\scriptsize\url{http://www.pps.univ-paris-diderot.fr/~jch/software/polipo/}}
   \end{itemize}
  \item \cod{squid}
   \vspace{-5mm}
   \begin{quote} 
   is a caching proxy for the Web supporting
   \end{quote}
   \begin{itemize}
     \item {\scriptsize\url{http://www.squid-cache.org/}}
   \end{itemize}
 \end{itemize}
\end{frame}


\begin{frame}{\cod{polipo}}{direkter Aufruf}
 \begin{description}[\target]
  \item[\host] Skript Server
  \begin{itemize}
   \item \cod{sh tools/polipo.sh}
  \end{itemize}
  \item[\target] Client
  \begin{itemize}
   \item \cod{curl --proxy http://192.168.7.1:8123  \textbackslash\\ http://www.google.ch}
  \end{itemize}
 \end{description}
\end{frame}

\begin{frame}{\target}{\cod{apt-get}}
 \begin{itemize}
  \item Konfiguration
  \begin{itemize}
   \item File \cod{apt.conf.d/05proxy}
   \begin{itemize}
    \item \cod{Acquire::http::proxy "{}http://192.168.7.1:8123"{};}
   \end{itemize}
  \end{itemize}
  \item Test
  \begin{itemize}
   \item \cod{apt-get update}
   \item \cod{apt-get install sshfs}
  \end{itemize}
 \end{itemize}
\end{frame}

\section{SSH}
\begin{frame}{\target}{Server \cod{socks}}
 \begin{itemize}
  \item \cod{ssh -D{\em port} user@host}
  \item \cod{curl --proxy socks5h localhost:{\em port} {\em http:address}}
  \item \cod{atp-get} funktioniert nicht
  \begin{itemize}
   \item File \cod{apt.conf.d/05proxy} 
    \begin{itemize}
     \item \cod{Acquire::http::proxy "{}socks4a://localhost:8123"{};}
	 \item[] oder ??
	 \item \cod{Acquire::socks::proxy "{}socks4a://localhost:8123"{};}
	 \item port=8123
    \end{itemize}
  \end{itemize}
 \end{itemize}
\end{frame}

\section{Forwarding}
\begin{frame}{Forwarding}{\host ist ein router}
 \begin{center}
  \includegraphics[width=0.875\textwidth]{router.pdf}
 \end{center}
 \begin{itemize}
  \item alle IP Protokolle 
  \item NAT Network Address Translation
 \end{itemize}
\end{frame}

\begin{frame}[fragile]{Konfiguration}
 \begin{description}[\target]
  \item[\host] \cod{tools/forwarding.sh}
  \item[\target] Setze gateway
  \begin{lstlisting}[language=bash]
  route add default gw host-ip usb0
  \end{lstlisting}
  \item Setze DNS Server
  \begin{itemize}
   \item \cod{cp config/resolv.conf /etc/resolv.conf}
  \end{itemize}
  einfach aber nicht universell
 \end{description}
\end{frame}

\section{Aufgaben}
\subsection{Proxy}

\begin{frame}{Aufgaben}{Proxy}
 \begin{itemize}
  \item Installiere Proxy
  \item Teste Proxy 
  \item Was wird auf den lokalen Netz übertragen 
  \begin{itemize}
   \item \cod{wireshark}
  \end{itemize}
  \item Setze \cod{apt-get} \& Co. so auf, dass \target per Internet/Proxy funktioniert 
 \end{itemize}
\end{frame}

\subsection{Forwarding}

\begin{frame}{Aufgaben}{Forwarding}
 \begin{itemize}
  \item Setze \host auf
  \item Setze \target auf
  \item Teste mit \cod{ping}
  \item Test mit \cod{apt-get}
 \end{itemize}
\end{frame}

\end{document}

